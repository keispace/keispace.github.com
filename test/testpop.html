<HTML>
    <HEAD>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <TITLE>keispace.js 테스트 페이지</TITLE>
        <script language="javascript"  src="./src/keispaceJs/keispace.js"></script>
    </HEAD>
    <BODY>
        <form name="form" id="form">
            <table cellspacing="0" cellpadding="0" style="border-collapse:collapse;">
                <tr>
                    <td width="30" align="center" class="td1_text" bgcolor="#EEEEEE">
                        &nbsp;
                    </td> 
                    <td width="200" align="center" class="td1_text" bgcolor="#EEEEEE">
                        이름
                    </td> 
                    <td width="100" align="center" class="td1_text" bgcolor="#EEEEEE">
                        나이
                    </td> 
                </tr>

                <tr height="30">
                    <td align="center" class="td1_text">
                        <input type="checkbox" class="input_box" name="pCheckbox" style="border:0px;" pName="정석모" pAge="27">
                    </td>
                    <td align="center" class="td1_text">
                        정석모
                    </td>
                    <td align="center" class="td1_text">
                        27세
                    </td>
                </tr>
                <tr>
                    <td height="5"></td>
                </tr> 

                <tr height="30">
                    <td align="center" class="td1_text">
                        <input type="checkbox" class="input_box" name="pCheckbox" style="border:0px;" pName="제임스 String" pAge="8">
                    </td>
                    <td align="center" class="td1_text">
                        제임스 String
                    </td>
                    <td align="center" class="td1_text">
                        8세
                    </td>
                </tr>
                <tr>
                    <td height="5"></td>
                </tr> 

                <tr height="30">
                    <td align="center" class="td1_text">
                        <input type="checkbox" class="input_box" name="pCheckbox" style="border:0px;" pName="마가렛 Number" pAge="10">
                    </td>
                    <td align="center" class="td1_text">
                        마가렛 Number
                    </td>
                    <td align="center" class="td1_text">
                        10세
                    </td>
                </tr>
                <tr>
                    <td height="5"></td>
                </tr> 

                <tr height="30">
                    <td align="center" class="td1_text">
                        <input type="checkbox" class="input_box" name="pCheckbox" style="border:0px;" pName="샬럿 Date" pAge="9">
                    </td>
                    <td align="center" class="td1_text">
                        샬럿 Date
                    </td>
                    <td align="center" class="td1_text">
                        9세
                    </td>
                </tr>
                <tr>
                    <td height="5"></td>
                </tr> 

                <tr height="30">
                    <td align="center" class="td1_text">
                        <input type="checkbox" class="input_box" name="pCheckbox" style="border:0px;" pName="윌리엄 Array" pAge="20">
                    </td>
                    <td align="center" class="td1_text">
                        윌리엄 Array
                    </td>
                    <td align="center" class="td1_text">
                        20세
                    </td>
                </tr>
                <tr>
                    <td height="5"></td>
                </tr> 

            </table>
        </form>

        <br>

        <button onclick="SendData();"> 보내기 </button>
        <button onclick="Close();"> 닫기 </button>




<script language=javascript>

function setData(CheckBox){ 
    if( CheckBox.checked )
    {
        var Data = keispace.DTOFactory.Create();
        Data.Add("pName");
        Data.Add("pAge");
        Data["pName"] = CheckBox.getAttribute( 'pName' );
        Data.pAge = CheckBox.getAttribute( 'pAge' );
    }
    return Data;
}
//데이터를 패키징 하여 부모 창으로 전송합니다.
function SendData()
{
    //  var isSelectedOneMore   = false;
    var CheckBoxes = $s("pCheckbox");
    var DataPackage = new Array();
    for( var nLoop = 0 ; nLoop < CheckBoxes.length ; nLoop++ ){ 
        if( CheckBoxes[nLoop].checked )
        DataPackage.push(setData(CheckBoxes[nLoop]));
    }
    if( DataPackage.length==0 ){
        alert("하나 이상 선택하셔야 합니다.");
    }else{
        try{
            console.log(opener);
            opener.RecieveData( DataPackage );          
        }catch (e){
            alert(e);
            console.log(e);
           
        }
    }
}

function Close(){
    window.close();
}

</script>
</BODY>
</HTML>
